"use strict";class dataList{constructor(e){this.$target=$(e.targetSelector),this.className=void 0!==e.className?e.className:"cards",this.url=void 0!==e.url?e.url:"//contest.elecard.ru/frontend_data/",this.targetFile=void 0!==e.file?e.file:"catalog.json",this.fishText="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce quis ipsum euismod, vulputate velit a, elementum velit.",this.data=[],this.cookieName="cardClosed"}init(){let e=this;e.$target.addClass(e.className),e.pager,$.getJSON(e.url+e.targetFile,"",function(t){e.data=t,e.pager=new Pagination({items:e.data}),e.pager.init(),e.renderPage(),e.$target.after(e.pager.$element),e.pager.$element[0].addEventListener("pagination.update",function(t){e.renderPage(),$("html").stop().animate({scrollTop:0},500,"swing")})})}renderPage(){let e=this,t=[],s=e.pager.current*e.pager.perPage;for(let a=e.pager.current*e.pager.perPage-e.pager.perPage;a<s;a++){let s=e.data[a];t.push($("<div>",{class:`${e.className}__item ${e._checkCookie(a)?"closed":""}`,html:[$(`<div class="${e.className}__image"><img src="${e.url+s.image}" /></div>`),$(`<p class="${e.className}__description">${s.description?s.description:e.fishText}</p>`),$("<button/>",{type:"button",class:`${e.className}__button-close`,text:"x"}).data("id",a).attr("data-id",a).on("click",function(){e.closeCard($(this).data("id"))})]}).data("id",a).attr("data-id",a))}e.$target.html(t)}closeCard(e){let t=$.cookie(this.cookieName),s=[];void 0!==t&&(s=t.split(",")),s.push(e),$.cookie(this.cookieName,s.join(","),{expires:7}),$(`.${this.className}__item[data-id="${e}"]`).addClass("closed")}_checkCookie(e){let t=$.cookie(this.cookieName);return void 0!==t&&t.split(",").filter(t=>t==e).length>0}}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){var t=/\+/g;function s(e){return n.raw?e:encodeURIComponent(e)}function a(e){return s(n.json?JSON.stringify(e):String(e))}function i(s,a){var i=n.raw?s:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),n.json?JSON.parse(e):e}catch(e){}}(s);return e.isFunction(a)?a(i):i}var n=e.cookie=function(t,r,o){if(arguments.length>1&&!e.isFunction(r)){if("number"==typeof(o=e.extend({},n.defaults,o)).expires){var c=o.expires,l=o.expires=new Date;l.setMilliseconds(l.getMilliseconds()+864e5*c)}return document.cookie=[s(t),"=",a(r),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}for(var u,d=t?void 0:{},p=document.cookie?document.cookie.split("; "):[],m=0,$=p.length;m<$;m++){var h=p[m].split("="),g=(u=h.shift(),n.raw?u:decodeURIComponent(u)),f=h.join("=");if(t===g){d=i(f,r);break}t||void 0===(f=i(f))||(d[g]=f)}return d};n.defaults={},e.removeCookie=function(t,s){return e.cookie(t,"",e.extend({},s,{expires:-1})),!e.cookie(t)}});class Pagination{constructor(e){this.items=e.items,this.perPage=void 0!==e.numItems?e.numItems:12,this.className=void 0!==e.className?e.className:"pagination",this.total=this.items.length,this.numPages=parseInt(this.total/this.perPage),this.current=1}init(){let e=this;e.$first=$("<button/>",{type:"button",class:`${e.className}__button first`,text:"|<"}).on("click",function(){e.update(1)}),e.$prev=$("<button/>",{type:"button",class:`${e.className}__button prev`,text:"<"}).on("click",function(){e.update(e.current-1)}),e.$next=$("<button/>",{type:"button",class:`${e.className}__button next`,text:">"}).on("click",function(){e.update(e.current+1)}),e.$last=$("<button/>",{type:"button",class:`${e.className}__button last`,text:">|"}).on("click",function(){e.update(e.numPages)}),e._updateProp(),e.$selector=$(`<div class="${e.className}__wrap-selector">Перейти на <select class="${e.className}__selector"></select></div>`),e.$selector=$("<select/>",{class:`${e.className}__selector`,html:function(){let t=[];for(let s=1;s<=e.numPages;s++)t.push(`<option value=${s}>${s}</option>`);return t}}).on("change",function(){e.update($(this).val())}),e.$current=$(`<label type="button" class="${e.className}__current">${e.current}</label>`),e.$element=$("<div/>",{class:this.className,html:[e.$first,e.$prev,e.$current,e.$next,e.$last]}),e.$element.append($("<div/>",{class:`${e.className}__wrap-selector`,html:[$("<label>Перейти на </label>"),e.$selector]}))}update(e){let t=this;if(e>=1||e<=this.numPages){t.current=e,t.$current.text(t.current),t._updateProp(),t.$selector.val(t.current);let s=new CustomEvent("pagination.update",{bubbles:!0,detail:{current:t.current,perPage:t.perPage,total:t.total}});t.$element[0].dispatchEvent(s)}}_updateProp(){this.$first.prop("disabled",!(this.current>1)),this.$prev.prop("disabled",!(this.current>1)),this.$next.prop("disabled",this.current>=this.numPages),this.$last.prop("disabled",this.current>=this.numPages)}}$(document).ready(function(){new dataList({targetSelector:".js-data-list"}).init()});