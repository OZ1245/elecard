"use strict";class dataList{constructor(t){this.$target=$(t.targetSelector),this.className=void 0!==t.className?t.className:"cards",this.url=void 0!==t.url?t.url:"//contest.elecard.ru/frontend_data/",this.targetFile=void 0!==t.file?t.file:"catalog.json",this.fishText="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce quis ipsum euismod, vulputate velit a, elementum velit.",this.data=[]}init(){let t=this;t.$target.addClass(t.className),t.pager,$.getJSON(t.url+t.targetFile,"",function(e){t.data=e,t.pager=new Pagination({items:t.data}),t.pager.init(),t.renderPage(),t.$target.after(t.pager.$element),t.pager.$element[0].addEventListener("pagination.update",function(e){t.renderPage()})})}renderPage(){let t=this,e=[],a=t.pager.current*t.pager.perPage;for(let s=t.pager.current*t.pager.perPage-t.pager.perPage;s<a;s++){let a=t.data[s];e.push($("<div>",{class:t.className+"__item",html:[$(`<div class="${t.className}__image"><img src="${t.url+a.image}" /></div>`),$(`<p class="${t.className}__description">${a.description?t.fishText:""}</p>`),$("<button/>",{type:"button",class:`${t.className}__button-close`,text:"x"}).data("id",s).attr("data-id",s).on("click",function(){t.closeCard($(this).data("id"))})]}).data("id",s).attr("data-id",s))}t.$target.html(e)}closeCard(t){$(`.${this.className}__item[data-id="${t}"]`).addClass(`${this.className}_closed`)}update(){}}class Pagination{constructor(t){this.items=t.items,this.perPage=void 0!==t.numItems?t.numItems:12,this.className=void 0!==t.className?t.className:"pagination",this.total=this.items.length,this.numPages=parseInt(this.total/this.perPage),this.current=1}init(){let t=this;t.$first=$("<button/>",{type:"button",class:`${t.className}__first`,text:"|<"}).on("click",function(){t.update(1)}),t.$prev=$("<button/>",{type:"button",class:`${t.className}__pref`,text:"<<"}).on("click",function(){t.update(t.current-1)}),t.$next=$("<button/>",{type:"button",class:`${t.className}__next`,text:">>"}).on("click",function(){t.update(t.current+1)}),t.$last=$("<button/>",{type:"button",class:`${t.className}__last`,text:">|"}).on("click",function(){t.update(t.numPages)}),t._updateProp(),t.$selector=$(`<div class="${t.className}__wrap-selector">Перейти на <select class="${t.className}__selector"></select></div>`),t.$selector=$("<select/>",{class:`${t.className}__selector`,html:function(){let e=[];for(let a=1;a<=t.numPages;a++)e.push(`<option value=${a}>${a}</option>`);return e}}).on("change",function(){t.update($(this).val())}),t.$current=$(`<label type="button" class="${t.className}__current">${t.current}</label>`),t.$element=$("<div/>",{class:this.className,html:[t.$first,t.$prev,t.$current,t.$next,t.$last]}),t.$element.append($("<div/>",{class:`${t.className}__wrap-selector`,html:[$("<label>Перейти на </label>"),t.$selector]}))}update(t){let e=this;if(t>=1||t<=this.numPages){e.current=t,e.$current.text(e.current),e._updateProp(),e.$selector.val(e.current);let a=new CustomEvent("pagination.update",{bubbles:!0,detail:{current:e.current,perPage:e.perPage,total:e.total}});e.$element[0].dispatchEvent(a)}}_updateProp(){this.$first.prop("disabled",!(this.current>1)),this.$prev.prop("disabled",!(this.current>1)),this.$next.prop("disabled",this.current>=this.numPages),this.$last.prop("disabled",this.current>=this.numPages)}}$(document).ready(function(){new dataList({targetSelector:".js-data-list"}).init()});